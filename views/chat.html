<!DOCTYPE html>

<!--
	This file is rendered by express.js, when the rurl /chat/123456 is visited in a browser.
	It includes jQuery, socket.io.js (it is automatically served by the socket.io library), 
	and a few more JavaScript files that you should check out.
-->

<html>

<head>

	<title>Identifique-se Ntxuva</title>

	 <link type="text/css" rel="stylesheet" href="../css/stylesheet.css" />
    <link href="../css/bootstrap.min.css" rel="stylesheet">
	<link href="http://fonts.googleapis.com/css?family=Open+Sans Condensed:300italic,300,700" rel="stylesheet" type="text/css">


</head>

<body>

	<section class="section">

		<!-- These elements are displayed as white info cards in the middle of the screen -->
        
        <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 identifique_se">
           
              <h3>Identifique-se</h3>
              <form class="loginForm">
                  <input style="    width: 300px; height: 40px; border: solid 2px #c59b7d;font-size: 20px;font-weight: bold;padding-left: 10px;border-radius: 3px;" type="text" id="teuNome" placeholder="Nome" />
                  <br>
                  <input style="margin: 40px;" type="submit" id="btmEnter" class="btm butao" value="AVANÇAR" />
              </form>

		</div>


        <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 conividar_amigo">
           
            <h3>Convide um amigo para competir com você</h3>
            <div class="link" style="    margin-top: 20px;">
				<span  style=" background-color: #dedede;padding: 10px;border-radius: 3px;font-size: 25px;font-weight: bold;" title="Invite a friend" href="" id="link"></span>
			</div>
            <p align="center" style="margin-top: 20px;font-weight: bold;">Envie este link para ele</p>

		</div>
        
        <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 identifique_se_convidado">
           
              <h3>Olá, <span class="nickname-chat"></span> lhe convidou para uma competição do jogo <strong>ntxuva</strong>. <br>Identifique-se</h3>
              <form class="loginForm">
                  <input style="width: 300px; height: 40px; border: solid 2px #c59b7d;font-size: 20px;font-weight: bold;padding-left: 10px;border-radius: 3px;" type="text" id="teuNome_convidado" placeholder="Nome" />
                  <br>
                  <input style="margin: 40px;" type="submit" id="btmEnter" class="btm butao" value="JOGAR" />
              </form>

		</div>
        
        <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 aguarde_inico_do_jogo">
           
              <h3>Aguarde...<br> o seu oponente vai iniciar o jogo...

		</div>
        
         <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 convidado_disponivel">
           
              <h3>O seu convidado está disponível <br>para competir com você</h3>
              
              <input style="margin: 40px;" type="submit" id="btmEnter" class="btm butao" value="JOGAR" onClick="Iniciar_Jogo();" />

		 </div>
         
         <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 oponente_saiu">
           
              <h3>O seu oponente saiu do jogo<br>convide outro oponente</h3>
              
               <div class="link" style="margin-top: 20px;">
				<span  style=" background-color: #dedede;padding: 10px;border-radius: 3px;font-size: 25px;font-weight: bold;" title="Invite a friend" href="" id="link_2"></span>
			   </div>
               <p align="center" style="margin-top: 20px;font-weight: bold;">Envie este link para ele</p>

		 </div>
         
         
         <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 solicitar_novo_jogo">
           
              <h3>Solicitação de nova jogo enviado com sucesso<br> Aguarde. o seu oponente vai iniciar o jogo...

		</div>
         
        <div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 solicitacao_de_novo_jogo">
           
              <h3>O seu oponente gostiria de competir com você mais uma vez</h3>
              
              <input style="margin: 40px;" type="submit" id="btmEnter" class="btm butao" value="JOGAR" onClick="Aceitar_Novo_Jogo();" />

		 </div>
        
        
        
        
		<div class="connected">

			<img src="../img/unnamed.jpg" id="creatorImage" />

			<div class="infoConnected">
				<h2>Who are you?</h2>
				<br/>

				<form class="loginForma">
					<input type="text" id="yourName" placeholder="Your nick name" /><br/>
					<input type="text" id="yourEmail" placeholder="Your email address" /><br/>
					<input type="submit" id="yourEnter" value="ENTER" />
				</form>

			</div>

		</div>

		<div class="personinside">

			<img src="../img/unnamed.jpg" id="ownerImage" />

			<div class="infoInside">
				<h2>Chat with <span class="nickname-chat"></span></h2>
				<br/>

				<form class="loginForma">
					<input type="text" id="hisName" placeholder="Your nick name" /><br/>
					<input type="text" id="hisEmail" placeholder="Your email address" /><br/>
					<input type="submit" id="hisEnter" value="CHAT" />
				</form>

			</div>

		</div>

		<div class="invite-textfield">

			<h2>Oops, there are no other people in this chat!</h2>
			<h5>Invite a friend by sending them this URL</h5>

			<div class="link">
				<a title="Invite a friend" href="" id="link_"></a>
			</div>

		</div>

		<div class="left">

			<img src="../img/unnamed.jpg" id="leftImage" />

			<div class="info">
				<h2><span class="nickname-left"></span> has left this chat.</h2>
				<h5>Invite somebody else by sending them this page.</h5>
			</div>

		</div>

		<div class="toomanypeople">

			<h2>Oops, you can not join this chat!</h2>
			<h5>There are already two people in it. Would you like to create a <a title="New Room" href="/create" id="room">new room</a>?</h5>

		</div>

		<div class="nomessages">

			<img src="../img/unnamed.jpg" id="noMessagesImage" />

			<div class="info">
				<h2>You are chatting with <span class="nickname-chat"></span>.</h2>
				<h5>Send them a message from the form below!</h5>
			</div>

		</div>

		<div class="chatscreen">

			<ul class="chats">
				<!-- The chat messages will go here -->
			</ul>

		</div>


    <style>

body table
{
	border: 0px #999999 solid;
}


body table td
{
	border: 0px #999999 solid;
}

#Tabuleiro
{
	display:none;
}
.dados
{
	/* cursor:wait; */	
}
.bg
{
	width: 100%;
	z-index: 2;
    position: absolute;
	max-width:1236px;
}

</style>

<div id="Tabuleiro" class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 tabuleiro" style="padding: 0;">

<div style="height:80px; width:100%; background-color:#C5C1C1;height: 80px;width: 100%;background-color: #6b5547;margin-top: -10px;">
  
  <div class="col-md-4 col-xs-4 col-sm-4" style="text-align:left;">
     <h4 style="color: white;    font-size: 15px;text-align: center;line-height: 1.5;"><span class="nickname-chat"></span><br>VS<br><span class="you_name"></span></h4>
      
  </div>
  <div class="col-md-8 col-xs-8 col-sm-8" style="background-color: rgba(0, 0, 0, 0.11);height: 80px;     padding: 0px;">
  <div id="Aviso"></div>
  </div>

</div>

<img src="../img/tabuleiro.png" class="img-responsive" style="width:100%; position: absolute;z-index: 1; max-width:1236px" >
<div class="bg">
<table>
  <tr>
    <td height="" id="Tabua_2_24"></td>
    <td id="Tabua_2_23"></td>
    <td id="Tabua_2_22"></td>
    <td id="Tabua_2_21"></td>
    <td id="Tabua_2_20"></td>
    <td id="Tabua_2_19"></td>
    <td id="Tabua_2_18"></td>
    <td id="Tabua_2_17"></td>
    <td id="Tabua_2_16"></td>
    <td id="Tabua_2_15"></td>
    <td id="Tabua_2_14"></td>
    <td id="Tabua_2_13"></td>
  </tr>
  <tr>
    <td height="" id="Tabua_2_1"></td>
    <td id="Tabua_2_2"></td>
    <td id="Tabua_2_3"></td>
    <td id="Tabua_2_4"></td>
    <td id="Tabua_2_5"></td>
    <td id="Tabua_2_6"></td>
    <td id="Tabua_2_7"></td>
    <td id="Tabua_2_8"></td>
    <td id="Tabua_2_9"></td>
    <td id="Tabua_2_10"></td>
    <td id="Tabua_2_11"></td>
    <td id="Tabua_2_12"></td>
  </tr>
</table>

<table>
  <tr>
     <td id="Tabua_1_12"></td>
     <td id="Tabua_1_11"></td>
     <td id="Tabua_1_10"></td>
     <td id="Tabua_1_9"></td>
     <td id="Tabua_1_8"></td>
     <td id="Tabua_1_7"></td>
     <td id="Tabua_1_6"></td>
     <td id="Tabua_1_5"></td>
     <td id="Tabua_1_4"></td>
     <td id="Tabua_1_3"></td>
     <td id="Tabua_1_2"></td>
     <td id="Tabua_1_1"></td>
  </tr>
  <tr>
    <td  id="Tabua_1_13"></td>
     <td id="Tabua_1_14"></td>
     <td id="Tabua_1_15"></td>
     <td id="Tabua_1_16"></td>
     <td id="Tabua_1_17"></td>
     <td id="Tabua_1_18"></td>
     <td id="Tabua_1_19"></td>
     <td id="Tabua_1_20"></td>
     <td id="Tabua_1_21"></td>
     <td id="Tabua_1_22"></td>
     <td id="Tabua_1_23"></td>
     <td id="Tabua_1_24"></td>
  </tr>
</table>
</div>
</div>

<footer>
  
    
		<form id="chatform">

			<textarea id="message" placeholder="Write something.."></textarea>
			<input type="submit" id="submit" value="SEND"/>

		</form>

	</footer>
</section>
<div class="col-xs-12 col-sm-12 col-md-8 col-md-offset-2 footer" style="padding: 0px;">
        <p style="margin-top: 10px;"><strong>Desenvolvido por:</strong> <a style="color:#ae764a;" href="https://facebook.com/issufo.arrone" target="_blank">Issufo Arrone</a> . <a style="color:#ae764a;" href="https://facebook.com/issufo.arrone" target="_blank">Comunidade de Jogadores</a> </p>
     </div>
	
<audio id="tom_1"> 
   <source src="../som/1.mp3" />  
</audio>
<audio id="tom_2"> 
   <source src="../som/2.mp3" />  
</audio>
<audio id="tom_3"> 
   <source src="../som/3.mp3" />  
</audio>
	<!-- <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script> -->
    <script src="../js/jquery-1.11.1.min.js"></script>
	<script src="../js/moment.min.js"></script>
	<script src="/socket.io/socket.io.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/waitingDialog.js"></script>
	<!-- <script src="../js/chat2.js"></script> -->
    
    <script>
	
	var Tom_1 = document.getElementById("tom_1");
	var Tom_2 = document.getElementById("tom_2");
	var Tom_3 = document.getElementById("tom_3");
	
	
	// getting the id of the room from the url
	var id = Number(window.location.pathname.match(/\/chat\/(\d+)$/)[1]);

	// connect to the socket
	var socket = io();
	
	// variables which hold the data for each person
	var name = "",
		email = "",
		img = "",
		friend = "";

	// cache some jQuery objects
	var section = $(".section"),
		footer = $("footer"),
		onConnect = $(".connected"),
		identifique_se = $(".identifique_se");
		inviteSomebody = $(".conividar_amigo"),
		personInside = $(".personinside"),
		chatScreen = $(".chatscreen"),
		left = $(".left"),
		noMessages = $(".nomessages"),
		tooManyPeople = $(".toomanypeople");
		Tabuleiro = $("#Tabuleiro");

	// some more jquery objects
	var chatNickname = $(".nickname-chat"),
		leftNickname = $(".nickname-left"),
		loginForm = $(".loginForm"),
		yourName = $("#teuNome"),
		yourEmail = $("#yourEmail"),
		hisName = $("#teuNome_convidado"),
		hisEmail = $("#hisEmail"),
		chatForm = $("#chatform"),
		textarea = $("#message"),
		messageTimeSent = $(".timesent"),
		chats = $(".chats");

	// these variables hold images
	var ownerImage = $("#ownerImage"),
		leftImage = $("#leftImage"),
		noMessagesImage = $("#noMessagesImage");


	// on connection to server get the id of person's room
	socket.on('connect', function(){

		socket.emit('load', id);
	});

	// save the gravatar url
	socket.on('img', function(data){
		img = data;
	});

	// receive the names and avatars of all people in the chat room
	socket.on('peopleinchat', function(data){

		if(data.number === 0){

			showMessage("identifique_se");

			loginForm.on('submit', function(e){

				e.preventDefault();

				name = $.trim(yourName.val());
				
				if(name.length < 1){
					alert("É obrigatório digitar o seu nome!");
					return;
				}
				
				showMessage("conividar_amigo");

				// call the server-side function 'login' and send user's parameters
				socket.emit('login', {user: name, avatar: '', id: id});
				Jogador  = 1;
				
			
			});
		}

		else if(data.number === 1) {

			showMessage("identifique_se_convidado",data);

			loginForm.on('submit', function(e){

				e.preventDefault();

				name = $.trim(hisName.val());

				if(name.length < 1){
					alert("É obrigatório digitar o seu nome!");
					return;
				}

				if(name == data.user){
					alert("O nome \"" + name + "\" já foi usado pelo seu oponente");
					return;
				}
				
					socket.emit('login', {user: name, avatar: '', id: id});
					Jogador  = 2;
				

			});
		}

		else {
			showMessage("tooManyPeople");
		}

	});

	// Other useful 

	socket.on('startChat', function(data){
		console.log(data);
		if(data.boolean && data.id == id) {

			chats.empty();

			if(name === data.users[0]) {

				//showMessage("youStartedChatWithNoMessages",data);
			}
			else {

				//showMessage("heStartedChatWithNoMessages",data);
			}

			chatNickname.text(friend);
		}
	});

	socket.on('leave',function(data){

		if(data.boolean && id==data.room){

			showMessage("oponente_saiu", data);
			//chats.empty();
			
			
		}

	});

	socket.on('tooMany', function(data){

		if(data.boolean && name.length === 0) {

			showMessage('tooManyPeople');
		}
	});

	socket.on('receive', function(data){

		showMessage('chatStarted');

		if(data.msg.trim().length) {
			createChatMessage(data.msg, data.user, data.img, moment());
			scrollToBottom();
		}
	});
	
	socket.on('receber_jogada', function(data){
			Jogada_2(data.cova);	
			Verificar_Vencedor();		
	});
	
	
	socket.on('receber_retirar_opositor_cova_dados', function(data){
			//Retirar_Opositor_Cova_Dados("2",data.cova);	
					Tabua_1[data.cova] = 0;
					$("#Tabua_1_"+(data.cova)).html(Alocar_Dados(1,0));	
			
			
			Verificar_Vencedor();	
	});
	
	socket.on('startGame', function(data){
			//Arumar_Tabuleiro();
			//showMessage("activar_tubuleiro");
			
			if(name === data.users[0]) {

				showMessage("convidado_disponivel",data);
				$(".nickname-chat").text(data.users[1]);
				$(".you_name").text(data.users[0]);
				
			}
			else
			{

				showMessage("aguarde_inico_do_jogo",data);
				$(".nickname-chat").text(data.users[0]);
				$(".you_name").text(data.users[1]);

			}
			
			//console.log(data.users[1]);
	});
	
	socket.on('iniciar_jogo', function(data){
		    Arumar_Tabuleiro();
			showMessage("activar_tubuleiro");
	});
	
	
	socket.on('solicitacao_de_novo_jogo', function(data){
			showMessage("solicitacao_de_novo_jogo");
	});
	
	socket.on('novo_jogo_aceite', function(data){
			Arumar_Tabuleiro();
			showMessage("activar_tubuleiro");
	});
	
	
	

	
	
	


	textarea.keypress(function(e){

		// Submit the form on enter

		if(e.which == 13) {
			e.preventDefault();
			chatForm.trigger('submit');
		}

	});

	chatForm.on('submit', function(e){

		e.preventDefault();

		// Create a new chat message and display it directly

		showMessage("chatStarted");

		if(textarea.val().trim().length) {
			createChatMessage(textarea.val(), name, img, moment());
			scrollToBottom();

			// Send the message to the other person in the chat
			socket.emit('msg', {msg: textarea.val(), user: name, img: img});

		}
		// Empty the textarea
		textarea.val("");
	});
	
	
	
	

	// Update the relative time stamps on the chat messages every minute

	setInterval(function(){

		messageTimeSent.each(function(){
			var each = moment($(this).data('time'));
			$(this).text(each.fromNow());
		});

	},60000);

	// Function that creates a new chat message
   
	
	function createChatMessage(msg,user,imgg,now){

		var who = '';

		if(user===name) {
			who = 'me';
		}
		else {
			who = 'you';
		}

		var li = $(
			'<li class=' + who + '>'+
				'<div class="image">' +
					'<img src=' + imgg + ' />' +
					'<b></b>' +
					'<i class="timesent" data-time=' + now + '></i> ' +
				'</div>' +
				'<p></p>' +
			'</li>');

		// use the 'text' method to escape malicious user input
		li.find('p').text(msg);
		li.find('b').text(user);

		chats.append(li);

		messageTimeSent = $(".timesent");
		messageTimeSent.last().text(now.fromNow());
	}

	function scrollToBottom(){
		$("html, body").animate({ scrollTop: $(document).height()-$(window).height() },1000);
	}

	function isValid(thatemail) {

		var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
		return re.test(thatemail);
	}

	function showMessage(status,data){
		
        if(status === "activar_tubuleiro"){

			section.children().css('display', 'none');
			$(".footer").css('display', 'none');
			Tabuleiro.fadeIn(1200);
			
		}
		
		
		if(status === "identifique_se"){

			section.children().css('display', 'none');
			$(".identifique_se").fadeIn(1200);
			
		}
		
		
		if(status === "conividar_amigo"){

			// Set the invite link content
			$("#link").text(window.location.href);

			identifique_se.fadeOut(1200, function(){
				inviteSomebody.fadeIn(1200);
			});
			
		}
		
		if(status === "identifique_se_convidado"){

			section.children().css('display', 'none');
			$(".identifique_se_convidado").fadeIn(1200);

			chatNickname.text(data.user);
		}
		
		if(status === "aguarde_inico_do_jogo"){

			section.children().css('display', 'none');
			$(".aguarde_inico_do_jogo").fadeIn(1200);
			
		}
		
		if(status === "convidado_disponivel"){

			section.children().css('display', 'none');
			$(".convidado_disponivel").fadeIn(1200);
			
		}
		
		
		
		if(status === "oponente_saiu"){

			// Set the invite link content
			$("#link_2").text(window.location.href);

			section.children().css('display', 'none');
			$(".oponente_saiu").fadeIn(1200);
			
			
		}
		
		if(status === "solicitar_novo_jogo"){

			section.children().css('display', 'none');
			$(".solicitar_novo_jogo").fadeIn(1200);
			
		}
		
		
		if(status === "solicitacao_de_novo_jogo"){

			section.children().css('display', 'none');
			$(".solicitacao_de_novo_jogo").fadeIn(1200);
			
		}
		
		
		
		

		else if(status === "inviteSomebody"){

			// Set the invite link content
			$("#link").text(window.location.href);

			onConnect.fadeOut(1200, function(){
				inviteSomebody.fadeIn(1200);
			});
		}

		else if(status === "personinchat"){

			onConnect.css("display", "none");
			personInside.fadeIn(1200);

			chatNickname.text(data.user);
			ownerImage.attr("src",data.avatar);
		}

		else if(status === "youStartedChatWithNoMessages") {

			left.fadeOut(1200, function() {
				inviteSomebody.fadeOut(1200,function(){
					noMessages.fadeIn(1200);
					footer.fadeIn(1200);
				});
			});

			friend = data.users[1];
			noMessagesImage.attr("src",data.avatars[1]);
		}

		else if(status === "heStartedChatWithNoMessages") {

			personInside.fadeOut(1200,function(){
				noMessages.fadeIn(1200);
				footer.fadeIn(1200);
			});

			friend = data.users[0];
			noMessagesImage.attr("src",data.avatars[0]);
		}

		else if(status === "chatStarted"){

			section.children().css('display','none');
			chatScreen.css('display','block');
		}

		else if(status === "somebodyLeft"){

			leftImage.attr("src",data.avatar);
			leftNickname.text(data.user);

			section.children().css('display','none');
			footer.css('display', 'none');
			left.fadeIn(1200);
		}

		else if(status === "tooManyPeople") {

			section.children().css('display', 'none');
			tooManyPeople.fadeIn(1200);
		}
	}


	function Enviar_Jogada(cova)
	{
		socket.emit('enviar_jogada', {cova: cova, jogador_id: id});
		
	}
	
	 function Enviar_Retirar_Opositor_Cova_Dados(cova)
	 {
		 socket.emit('enviar_retirar_opositor_cova_dados', {cova: cova, jogador_id: id});
	 }
	 
	 
	 function Iniciar_Jogo()
	 {
		 socket.emit('iniciar_jogo');
		 Arumar_Tabuleiro();
		 showMessage("activar_tubuleiro");
	 }
	 
	 function Novo_Jogo()
	 {
		  socket.emit('novo_jogo', { jogador_id: id});
		  showMessage("solicitar_novo_jogo");
	 }
	 
	 function Aceitar_Novo_Jogo()
	 {
		 socket.emit('novo_jogo_aceite');
		 Arumar_Tabuleiro();
		 showMessage("activar_tubuleiro");
	 }
	 
	
	</script>
    
    
    <script>


	var Tabua_1 = new Array();
	var Tabua_2 = new Array();
	var Escolher_Covas_Opositor = "off";
	var Escolher_Covas_Opositor_Cont = 0;
	var Suspensor_De_Jogo = "off";
    var Jogador;
    
	//Arumar_Tabuleiro();
	
	function Arumar_Tabuleiro()
	{
		
		Escolher_Covas_Opositor = "off";
	    Escolher_Covas_Opositor_Cont = 0;
	    Suspensor_De_Jogo = "off";
	
		for(var i=1;i<=24;i++)
		{
			Tabua_1[i] = 2;
			Tabua_2[i] = 2;
			$("#Tabua_1_"+i).html(Alocar_Dados(1,Tabua_1[i]));
			$("#Tabua_2_"+i).html(Alocar_Dados(2,Tabua_1[i]));
			Cova_On_Clik(1,i);
			Cova_On_Clik(2,i);
		}
		
		$("#Tabuleiro").fadeIn(1000);
		
		if(Jogador==1){ Aviso("<b>Inicio do Jogo<br>"+name+"</b> você começa o jogo");  }	
		if(Jogador==2){ Aviso("<b>Inicio do Jogo<br> Aguarde, a jogada do seu oponente");  }	
	}


	function Alocar_Dados(Tabuleiro,Quantidade)
	{
		
		return "<img class='dados img-responsive'  src='../dados/"+Tabuleiro+"_"+Quantidade+".png' />";
	}
	
	
	function Cova_On_Clik(Tabuleiro,Cova)
	{
		
		$("#Tabua_"+Tabuleiro+"_"+Cova).click(function()
		{
			
			if(Suspensor_De_Jogo=="off")
			{
				
				  if(Escolher_Covas_Opositor=="on")
				  {
					  
					   if(Jogador!=Tabuleiro)
					  {
					  
					  
							if(Tabuleiro==1)
							{
									if(Tabua_1[Cova]==0)
									{
										Aviso("Cova sem dados suficietes, escolha outra cova");	
									}
									else
									{   
										Retirar_Opositor_Cova_Dados(Tabuleiro,Cova);
										Enviar_Retirar_Opositor_Cova_Dados(Cova);
									}
							}
							
							if(Tabuleiro==2)
							{
									
									if(Tabua_2[Cova]==0)
									{
										Aviso("Cova sem dados suficietes, escolha outra cova");	
									}
									else
									{
										Retirar_Opositor_Cova_Dados(Tabuleiro,Cova);
										Enviar_Retirar_Opositor_Cova_Dados(Cova);
									}
							}
					  }
					  else
					  {
						  if(Jogador==1){ Aviso("<b>"+name+"</b> Tire 2 dados do seu oponente");  }	
						  if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente");  }	
					  }
				  
					  
				  }
				  else
				  {
					  if(Jogador==Tabuleiro)
					  {
					  
						  if(Tabuleiro==1)
						  {
							  Jogada_1(Cova);
							  Enviar_Jogada(Cova);
						  }
						  
						  if(Tabuleiro==2)
						  {
							  //Jogada_2(Cova);
							  Aviso("Aguarde a jogada do seu oponente");
						  }
						  
						  
						  
					  }
					  else
					  {
						  if(Jogador==1){ Aviso("<b>"+name+"</b> Jogue dados do seu lado e não do seu oponente");  }	
						  if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente");  }	
					  }
				  }
				
				 
				
			}
			
			 Verificar_Vencedor();
				 
		}
		);
	}
	
	function Retirar_Opositor_Cova_Dados(Tabuleiro,Cova)
	{
		
		if(Jogador!=Tabuleiro)
		{
			Tom_2.play();
		
			if(Tabuleiro==1)
			{
					Tabua_1[Cova] = 0;
					$("#Tabua_1_"+(Cova)).html(Alocar_Dados(1,0));	
			}
			
			if(Tabuleiro==2)
			{
					Tabua_2[Cova] = 0;
					$("#Tabua_2_"+(Cova)).html(Alocar_Dados(2,0));	
			}
			
			Escolher_Covas_Opositor_Cont++;
			
			if(Escolher_Covas_Opositor_Cont==2)
			{
				Escolher_Covas_Opositor = "off";	
				Escolher_Covas_Opositor_Cont = 0;
				
				if(Jogador==1){ Aviso("<b>"+name+"</b> continue sua jogada");  }	
				if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente");  }	
			}
			
			
		
		}
		else
		{
			//if(Jogador==1){ Aviso("<b>"+name+"</b> escolha 2 covas do oponente");  }	
		    if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente (ele vai esvaziar 2 das tuas covas)");  }	
		}
	}
	
	
	function Jogada_1(Cova)
	{
		
		if(Tabua_1[Cova]!=0 && (Tabua_1[Cova]!=1 || Verificar_Jogada_Com_Uma_Pedra(1)) )
		{
			
			//Tom_1.play();
			
		    Dados = Tabua_1[Cova];
			$("#Tabua_1_"+Cova).html(Alocar_Dados(1,"0"));
			Tabua_1[Cova] = 0;
			
			Distribuir_Pedras_1(Cova,Dados);
			
			
		}
		else
		{
		 	Aviso("Cova sem dados suficietes");	
		}
	}
	
	
	function Jogada_2(Cova)
	{
		
		if(Tabua_2[Cova]!=0 && (Tabua_2[Cova]!=1 || Verificar_Jogada_Com_Uma_Pedra(2)))
		{
			
		    Dados = Tabua_2[Cova];
			$("#Tabua_2_"+Cova).html(Alocar_Dados(2,"0"));
			
			Tabua_2[Cova] = 0;
			
			Distribuir_Pedras_2(Cova,Dados);
			
		}
		else
		{
		 	//Aviso("Cova sem dados suficietes");	
		}
	}
	
	function Distribuir_Pedras_1(Cova,Dados)
	{
		
		   if(Dados!=0)
		   {
			   
			    Suspensor_De_Jogo="on";
			
			    Tom_1.play();
				
				Cova++;
				
				if(Cova>24)
				{
					Cova = 1;	
				}
			
				Tabua_1[Cova] = Tabua_1[Cova]+1;
				$("#Tabua_1_"+(Cova)).fadeOut(0,
				function()
				{
					
					$("#Tabua_1_"+(Cova)).html(Alocar_Dados(1,Tabua_1[Cova]));
				    $("#Tabua_1_"+(Cova)).fadeIn(400,
					function()
					{
						Dados--;
						Distribuir_Pedras_1(Cova,Dados);
					});
					
				});
		   }
		   else
		   {
			   
				  if(Tabua_1[Cova]!=0 && Tabua_1[Cova]!=1)
				  {
					  Jogada_1(Cova);
				  }
				  else
				  {
					  //verificar Se Bateu
					  Cova_Oposta = Tabuleiro_Covas_Oposta(Cova);
					 
					  //verificar Se Bateu
					  if(Cova>=1 && Cova<=12 && Tabua_2[Cova_Oposta[0]]!=0)
					  {	  
					      Escolher_Covas_Opositor = "on";				  
						  Tirar_Inimigo_Pedras(1,Cova_Oposta);
					  }
					  else
					  {
						  Jogador = 2;
						  if(Jogador==1){ Escolher_Covas_Opositor = "off"; Suspensor_De_Jogo="off"; Aviso("<b>"+name+"</b> é sua vez de jogar");  }	
						  if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente");  }	
						  
					  }
					  
					  //console.log("Fim da jogada");	
					  
				  }
			
		   }
							
	}
	
	function Distribuir_Pedras_2(Cova,Dados)
	{
		   
		   if(Dados!=0)
		   {
			    Suspensor_De_Jogo="on";
				
				Cova++;
				
				if(Cova>24)
				{
					Cova = 1;	
				}
			
				Tabua_2[Cova] = Tabua_2[Cova]+1;
				$("#Tabua_2_"+(Cova)).fadeOut(200,
				function()
				{
					
					$("#Tabua_2_"+(Cova)).html(Alocar_Dados(2,Tabua_2[Cova]));
				    $("#Tabua_2_"+(Cova)).fadeIn(200,
					function()
					{
						Dados--;
						Distribuir_Pedras_2(Cova,Dados);
					});
					
				});
		   }
		   else
		   {
		
				  if(Tabua_2[Cova]!=0 && Tabua_2[Cova]!=1)
				  {
					  Jogada_2(Cova);
				  }
				  else
				  {
					  Cova_Oposta = Tabuleiro_Covas_Oposta(Cova);
					 
					  //verificar Se Bateu
					  if(Cova>=1 && Cova<=12 && Tabua_1[Cova_Oposta[0]]!=0)
					  {
						  Tirar_Inimigo_Pedras(2,Cova_Oposta);
					  }
					  else
					  {
						  
						  Jogador = 1;
						  if(Jogador==1){ Escolher_Covas_Opositor = "off"; Suspensor_De_Jogo="off"; Aviso("<b>"+name+"</b> é sua vez de jogar");  }	
						  if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente");  }	
						  
					  }
					  
					  //console.log("Fim da jogada");	
					  
				  }
		   }
		   
		
	}
	
	
	function Tabuleiro_Covas_Oposta(Cova)
	{
		var A = new Array();
		
		A[1] = Array(12,13);
		A[2] = Array(11,14);
		A[3] = Array(10,15);
		A[4] = Array(9,16);
		A[5] = Array(8,17);
		A[6] = Array(7,18);
		A[7] = Array(6,19);
		A[8] = Array(5,20);
		A[9] = Array(4,21);
		A[10] = Array(3,22);
		A[11] = Array(2,23);
		A[12] = Array(1,24);
		
		return A[Cova];
	}
	
	function Tirar_Inimigo_Pedras(Jogador,Cova)
	{
		
		
		
		if(Jogador==1)
		{
					Tom_3.play();
					Tabua_2[Cova[0]] = 0;
					Tabua_2[Cova[1]] = 0;
					$("#Tabua_2_"+(Cova[0])).html(Alocar_Dados(2,0));
					$("#Tabua_2_"+(Cova[1])).html(Alocar_Dados(2,0));
					
					//Escolher_Covas_Opositor = "on";
					if(Jogador==1){ Suspensor_De_Jogo="off"; Aviso("<b>"+name+"</b> escolha 2 covas do oponente");  }	
					if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente (ele vai esvaziar 2 das tuas covas)");  }	
			
		}
		
		if(Jogador==2)
		{
					Tabua_1[Cova[0]] = 0;
					Tabua_1[Cova[1]] = 0;
					$("#Tabua_1_"+(Cova[0])).html(Alocar_Dados(1,0));
					$("#Tabua_1_"+(Cova[1])).html(Alocar_Dados(1,0));
					
					//Escolher_Covas_Opositor = "on";
					if(Jogador==1){ Suspensor_De_Jogo="off"; Aviso("<b>"+name+"</b> escolha 2 covas do oponente");  }	
					if(Jogador==2){ Aviso("Aguarde a jogada do seu oponente (ele vai esvaziar 2 das tuas covas)");  }	
		}
		
		Verificar_Vencedor();
	}
	
	
	function Verificar_Vencedor()
	{
		Jogador_1 = 0;
		Jogador_2 = 0;
		
		for(var i=1;i<=24;i++)
		{
			Jogador_1 = Jogador_1 + Tabua_1[i];
			Jogador_2 = Jogador_2 + Tabua_2[i];
		}
		
		if(Jogador_1==0){ Suspensor_De_Jogo=="on"; Aviso("Opss,<b>"+name+"</b> você perdeu. <a href='#' onClick='Novo_Jogo();'><b>Novo Jogo</b></a>"); }
		if(Jogador_2==0){ Suspensor_De_Jogo=="on"; Aviso("Parabéns <b>"+name+"</b> você ganhou. <a href='#' onClick='Novo_Jogo();'><b>Novo Jogo</b></a>"); }
		
	}
	
	function Verificar_Jogada_Com_Uma_Pedra(Tabuleiro)
	{
		
		if(Tabuleiro==1)
		{
		
			for(var i=1;i<=24;i++)
			{
				
				if(Tabua_1[i]>1){ return false; }
				
			}
		    
			return true;
			
		}
		
		if(Tabuleiro==2)
		{
		
			for(var i=1;i<=24;i++)
			{
				
				if(Tabua_2[i]>1){ return false; }
				
			}
		    
			return true;
			
		}
		
		
	}
	
	
	
	
	
	
	
	function Aviso(Mensagem)
	{
	                            $("#Aviso").fadeOut
								(100,
									function()
									{
										Atributo = 	'<div class="alert alert-success" role="alert" style="height: 80px;border-radius: 0px;">'+Mensagem+'</div>';
										
										$("#Aviso").html(Atributo);	
										$("#Aviso").fadeIn(100);
															 
									}
								);
								
								
	}
	
	
	
	

</script>


</body>

</html>